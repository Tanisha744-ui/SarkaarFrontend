<div class="game-container">
  <div class="imposter-container">

    <!-- HOME -->
    <div class="card" *ngIf="step === 'home'">
      <h2 class="neon-title">Imposter Game</h2>
      <p class="subtle-text">Create or join a lobby to start playing</p>

      <button class="action-btn create-btn" (click)="goCreate()">
        üéÆ Create Lobby
      </button>

      <button class="action-btn join-btn" (click)="goJoin()">
        üîë Join Lobby
      </button>

    </div>

    <!-- CREATE -->
    <div class="card" *ngIf="step === 'create'">
      <h2>Create Lobby</h2>
      <input placeholder="Your Name" [(ngModel)]="playerName">
      <input type="number" min="3" placeholder="Number of Players" [(ngModel)]="maxPlayers">
      <button class="primary" (click)="createLobby()">Create</button>
    </div>

    <!-- JOIN -->
    <div class="card" *ngIf="step === 'join'">
      <h2>Join Lobby</h2>
      <input placeholder="Your Name" [(ngModel)]="playerName">
      <input placeholder="Lobby Code" [(ngModel)]="lobbyCode">
      <button class="primary" (click)="joinLobby()">Join</button>
    </div>

    <!-- LOBBY -->
    <!-- LOBBY -->
    <div class="card lobby-card" *ngIf="step === 'lobby'">

      <h2 class="lobby-title">Lobby Code</h2>

      <div class="code-box">
        <span class="code-text">{{ lobbyCode }}</span>

        <button class="copy-btn" (click)="copyCode()">
          üìã Copy
        </button>
      </div>

      <p class="lobby-subtext">
        Share this code with your friends to join
      </p>

      <p class="waiting-text">
        Waiting for players to join‚Ä¶
      </p>

    </div>


    <!-- WORD -->
    <div class="card word-phase-card" [ngClass]="{'word-showing': showWord}" *ngIf="step === 'word'">
      <div class="word-container">
        <div *ngIf="showWord">
          <div class="secret-word small-word-box">
            {{ word }}
          </div>
          <div class="timer-text">Visible for {{ wordTimer }}s</div>
          <div *ngIf="isImposter" class="imposter-alert">
            You are the Imposter!
          </div>
        </div>
        <div *ngIf="!showWord">
          <div class="secret-word hidden">
            üîí Word Locked üîí
          </div>
          <div class="subtle-text">Wait for admin to choose mode...</div>
          <div *ngIf="isHost" class="admin-choice" style="margin-top:18px;">
            <button class="primary" (click)="chooseMode('online')">Play Online</button>
            <button class="secondary" (click)="chooseMode('offline')">Play Offline</button>
          </div>
        </div>
      </div>
    </div>


    <!-- MODE (HOST ONLY) -->
    <div class="card" *ngIf="step === 'mode'">
      <h2 class="neon-title">Choose Game Mode</h2>
      <p class="subtle-text">Select how you want to play</p>

      <button class="primary" (click)="chooseMode('online')">
        üåê Online (Chat + Clues)
      </button>

      <button class="secondary" (click)="chooseMode('offline')">
        üé≤ Offline (Reveal Imposter)
      </button>
    </div>


    <!-- OFFLINE -->
    <div class="card imposter-reveal-card" *ngIf="step === 'offline'">
      <h2 style="text-align:center;">Offline Mode</h2>
      <div *ngIf="imposterName">
        <div class="imposter-result reveal-center">
          <div class="imposter-reveal-label">The Imposter is</div>
          <div class="imposter-name reveal-name">{{ imposterName }}</div>
        </div>
      </div>
      <!-- ADMIN CONTROLS -->
      <div class="admin-panel" *ngIf="isAdmin">
        <button class="reveal-btn" *ngIf="!imposterRevealed" (click)="revealImposter()">
          üîç Reveal Imposter
        </button>
      </div>
    </div>

    <!-- CLUE ENTRY -->
    <div class="card" *ngIf="step === 'clue-entry'">
      <h2>Enter Your Clue</h2>
      <input [(ngModel)]="myClue" placeholder="Type your clue..." [disabled]="!!clues[playerName]" />
      <button class="primary" (click)="submitClue()" [disabled]="!!clues[playerName] || !myClue.trim()">Submit</button>
      <div class="subtle-text" *ngIf="!!clues[playerName]">Waiting for others...</div>
    </div>

    <!-- CLUE REVIEW -->
    <div class="card" *ngIf="step === 'clue-review'">
      <h2>All Clues (Round {{ round }})</h2>
      <ul>
        <li *ngFor="let player of players">
          <span class="highlight">{{ player }} : </span>
          <span>{{ clues[player] }}</span>
        </li>
      </ul>
      <!-- <div class="timer-text">Visible for {{ clueTimer }}s</div> -->
      <div class="proceed-controls">
        <button
          class="primary"
          *ngIf="round < 3"
          (click)="proceedOrNextRound('next')"
          [disabled]="proceedVotes[playerName]"
        >Play Next Round</button>
        <button
          class="secondary"
          (click)="proceedOrNextRound('vote')"
          [disabled]="proceedVotes[playerName]"
        >Proceed to Voting</button>
        <div *ngIf="proceedVotes[playerName]" class="subtle-text">
          Waiting for others...
        </div>
      </div>
    </div>

    <!-- VOTING -->
    <div class="card" *ngIf="step === 'voting'">
      <h2>Vote for the Imposter</h2>
      <div class="vote-card-list">
        <button
          class="vote-btn"
          *ngFor="let player of players"
          [disabled]="player === playerName || votedFor"
          (click)="voteFor(player)"
          [ngClass]="{'self-vote': player === playerName}"
        >
          {{ player }}
        </button>
      </div>
      <div *ngIf="votedFor" class="subtle-text">Waiting for others to vote...</div>
    </div>

    <!-- RESULT -->
    <div class="card" *ngIf="step === 'result' && votingResult">
      <h2>Voting Result</h2>
      <div *ngIf="votingResult.imposterCaught" class="success-text">
         The imposter <b>{{ votingResult.imposter }}</b> was caught!
      </div>
      <div *ngIf="!votingResult.imposterCaught" class="danger-text">
         The imposter <b>{{ votingResult.imposter }}</b> escaped!<br>
        <span *ngIf="votingResult.accused !== votingResult.imposter">
          The group accused <b>{{ votingResult.accused }}</b>.
        </span>
      </div>
    </div>
  </div>
</div>